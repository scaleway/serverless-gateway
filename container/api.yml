# Default Kong config for the gateway

_format_version: '2.1'
_transform: true

routes:
# Scaleway base route
- name: base
  paths:
  - /
  service: base
# Scaleway admin route
- name: scw
  paths:
  - /scw
  service: scw
# Scaleway auth route
- name: auth
  paths:
    - /auth
  service: auth

# Ping route to act as default
- name: ping-checker
  paths:
  - /ping
  service: ping-checker

services:
# Default ping backend
- name: ping-checker
  url: http://ping-checker/ping

# Scaleway admin plugin backend
- name: scw
  url: http://ping-checker/ping
  plugins:
  - name: scw-sls-gw
    config:
      admin_url: http://localhost:8001
  - name: key-auth
    config:
      key_names:
        - X-Auth-Token

# Scaleway auth plugin backend
- name: auth
  url: http://ping-checker/ping
  plugins:
  - name: scw-sls-auth
    config:
      admin_url: http://localhost:8001

# Scaleway base 
- name: base
  url: http://ping-checker/ping
  plugins:
  - name: request-termination
    config: 
      status_code: 200
      message: Hello from GW!

# Consumers
consumers:
- username: "admin"

# Authentication
keyauth_credentials:
- consumer: "admin"
  key: "admin"
